---
title: "Statistical Inference - Analysis of Exponential Dsistribution"
author: "Sandro Vicente"
date: "Saturday, May 16, 2015"
output: html_document
---
### Overview

 In a few (2-3) sentences explain what is going to be reported on.

### Simulations

Parameters used for the experiment

```{r}
nosim <- 1000 # number simulations
n <- 40
lambda <- 0.2 
```

Calculate theoretical mean and standard deviations

```{r}
m.dist <- 1/lambda
sd.dist <- 1/lambda

m.dist
sd.dist

```

Generate data using the exponential distribution

```{r}
ALL <- rexp(nosim*n, lambda) # all data

MEAN <- matrix(ALL, nosim)   # split in blocks of 'n' samples
means <- apply(MEAN, 1, mean) # calculate the mean of each block
```

Plot of the original sample

```{r}
library(ggplot2)

DF.ALL <- data.frame(values=ALL)
ggplot(DF.ALL, aes(x=values)) + geom_histogram(binwidth=.1, aes(y= ..density..)) + xlim(0, 35) + xlab("All values") + ggtitle("Density of raw samples") + geom_vline(aes(xintercept=5), colour="red")
```

However, when we plot the distribution of values for the means of groups of 'n' = `r n` values:

```{r}
DF <- data.frame(means=means)

ggplot(DF.ALL, aes(x=means)) + geom_histogram(binwidth=.1, aes(y= ..density..)) + ggtitle("Density of means of 'n' values") + geom_vline(aes(xintercept=5), colour="red")

```

Now calculate the mean and sd from ALL values

```{r}

m.all <- mean(ALL)
sd.all <- sd(ALL)

m.all
sd.all

```

Calculate the mean and sd for the averages of 'n' samples
    
```{r}

m.means <- mean(means)
sd.means <- sd(means) # sd calculated from the means of 'n' samples

sd.n <- sd.all/sqrt(n) # sd based on original sd, corrected for mean of 'n' samples

m.means
sd.means
sd.n

```

The theoretical value for sd of a sample of size 'n'=`r n` is:
```{r}
sd.dist / sqrt(n) 
```

### Analysis of the results

Now plot a the distribution of means and compare it agaist a normal distribution of same mean and sd

```{r}

ggplot(DF, aes(x=means)) + geom_histogram(alpha=0.3,binwidth=.1, aes(y= ..density..)) + stat_function(fun=dnorm, args=list(mean=m.means, sd=sd.means)) 
```
